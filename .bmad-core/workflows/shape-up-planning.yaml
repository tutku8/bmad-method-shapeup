# <!-- Powered by BMADâ„¢ Core -->
workflow:
  id: shape-up-planning
  name: Shape Up Pitch Creation
  description: >-
    Shape Up methodology workflow that guides existing BMad agents to create
    appetite-disciplined pitches with fat marker solutions and circuit breakers
  type: shape-up
  project_types:
    - feature-enhancement
    - new-feature
    - user-experience-improvement
    - system-improvement
    - brownfield-enhancement

  sequence:
    - step: appetite_definition
      agent: bmad-orchestrator
      action: define appetite constraints
      notes: |
        CRITICAL: Start with appetite, not solution exploration
        Ask user:
        - What's the time investment you're willing to make? (weeks, people)
        - How much is this problem worth to your business?
        - What are you NOT willing to spend on this?
        Set appetite constraints that will drive all subsequent decisions.

    - agent: analyst
      action: validate-problem-and-appetite (use advanced-elicitation, interactive mode)
      creates: docs/problem-validation.md
      requires: appetite_constraints
      interactive: true
      notes: |
        ANALYST SHAPE UP FOCUS: Problem & Appetite Validation
        - Use advanced elicitation to ask clarifying questions about the problem
        - Validate raw problem definition with user evidence through interactive dialogue
        - Validate appetite against problem significance via questioning
        - Identify complexity risks and rabbit holes using advanced elicitation techniques
        - Define circuit breakers and stopping triggers through user collaboration
        - NO solution exploration - pure problem/appetite validation
        - MUST ask clarifying questions before proceeding

    - agent: pm
      action: create-business-scope-analysis (use advanced-elicitation, interactive mode)
      creates: docs/business-scope.md
      requires: docs/problem-validation.md
      interactive: true
      notes: |
        PM SHAPE UP FOCUS: Business Perspective & Scope
        - Use advanced elicitation to understand business context through questions
        - Business perspective and stakeholder impact analysis via interactive dialogue
        - Scope boundaries definition and "no-gos" through collaborative discussion
        - Risk mitigation from business/stakeholder perspective with user input
        - Success metrics and business outcomes through guided questioning
        - Stakeholder communication planning with user clarification
        - MUST ask clarifying questions about business context and constraints

    - agent: ux-expert
      action: create-fat-marker-sketches (use advanced-elicitation, interactive mode)
      creates: docs/solution-sketches.md
      requires: docs/business-scope.md
      interactive: true
      notes: |
        UX EXPERT SHAPE UP FOCUS: Fat Marker Sketches & Affordances
        - Use advanced elicitation to understand user workflows through questions
        - Fat marker solution sketches using breadboarding technique with user input
        - Define places, affordances, and connections (per Shape Up Ch.4) collaboratively
        - High-level user flows without visual details, validated through dialogue
        - Solution direction preserving developer autonomy, confirmed with user
        - Focus on "what" and "where" not "how" through guided questioning
        - MUST ask clarifying questions about user workflows and solution approach

    - agent: po
      action: validate-deliverability-and-risks (use advanced-elicitation, interactive mode)
      creates: docs/deliverability-assessment.md
      requires: docs/solution-sketches.md
      interactive: true
      notes: |
        PO SHAPE UP FOCUS: Deliverability & Risk Management
        - Use advanced elicitation to understand delivery constraints through questions
        - Validate appetite vs scope alignment through interactive dialogue
        - Assess deliverability within timeframe with user input on team capabilities
        - Circuit breaker validation and risk mitigation through collaborative discussion
        - Task/epic breakdown (can be separate artifact) with user guidance
        - Betting table preparation with user confirmation of key decisions
        - MUST ask clarifying questions about team capacity and delivery constraints

    - agent: architect
      action: technical-feasibility-review (use advanced-elicitation, interactive mode)
      creates: docs/technical-assessment.md
      requires: docs/solution-sketches.md
      optional: true
      condition: codebase_access_available
      interactive: true
      notes: |
        ARCHITECT SHAPE UP FOCUS: Technical Feasibility (Optional)
        - Use advanced elicitation to understand technical constraints through questions
        - Technical feasibility within appetite constraints via interactive dialogue
        - Integration complexity assessment with existing systems through user input
        - Technical risk identification and mitigation with collaborative discussion
        - Architecture guidance without over-prescription, validated with user
        - Preserve implementation flexibility for developers through guided questioning
        - MUST ask clarifying questions about technical context and constraints

    - step: pitch_finalization
      agent: bmad-orchestrator
      action: shape-up-methodology-compliance (use shape-up-final-pitch-tmpl)
      creates: docs/shape-up-final-pitch.md
      requires: docs/deliverability-assessment.md
      template: shape-up-final-pitch-tmpl.yaml
      notes: |
        Final Shape Up methodology compliance check:
        - Consolidate all artifacts into final pitch using template
        - Ensure all Shape Up elements present (problem, appetite, solution, circuit breakers)
        - Validate developer autonomy preserved throughout
        - Confirm appetite discipline maintained in all sections
        - Ready pitch for betting table presentation
        - Convert to final pitch format for team handoff
        - Save final pitch to docs/ folder for persistence

  flow_diagram: |
    ```mermaid
    graph TD
        A[Start: Raw Problem/Idea] --> B[bmad-orchestrator: Define Appetite]
        B --> C[analyst: Problem & Appetite Validation]
        C --> D[pm: Business Scope Analysis]
        D --> E[ux-expert: Fat Marker Sketches]
        E --> F[po: Deliverability & Risk Assessment]
        F --> G{Codebase Access?}
        G -->|Yes| H[architect: Technical Feasibility]
        G -->|No| I[bmad-orchestrator: Final Validation]
        H --> I
        I --> J{Issues Found?}
        J -->|Yes| K[Return to relevant agent]
        J -->|No| L[Final Shape Up Pitch Ready]
        K --> F

        style L fill:#90EE90
        style B fill:#FFE4B5
        style C fill:#FFE4B5
        style D fill:#FFE4B5
        style E fill:#DDA0DD
        style F fill:#F0E68C
        style H fill:#87CEEB
        style I fill:#ADD8E6
    ```

  decision_guidance:
    when_to_use:
      - Need appetite-disciplined planning instead of feature-complete requirements
      - Want to avoid over-specification for development teams
      - Building pitches for betting table decisions
      - Need circuit breakers for complexity management
      - Want to preserve developer technical autonomy
      - Following Shape Up methodology principles

  agent_guidance:
    analyst_shape_up_mode:
      - Validate raw problem with user evidence and data
      - Validate appetite against problem significance and business impact
      - Use advanced elicitation to identify rabbit holes and complexity traps
      - Define circuit breakers based on appetite protection
      - NO solution exploration - pure problem/appetite validation

    pm_shape_up_mode:
      - Focus on business perspective and stakeholder impact
      - Define scope boundaries and clear "no-gos"
      - Business risk mitigation and stakeholder communication
      - Success metrics and business outcomes definition
      - Appetite discipline from business perspective

    ux_expert_shape_up_mode:
      - Create fat marker sketches using breadboarding technique
      - Define places, affordances, and connections (Shape Up Ch.4)
      - High-level user flows without visual design details
      - Solution direction that preserves developer autonomy
      - Focus on "what" and "where" not "how" to implement

    po_shape_up_mode:
      - Validate appetite vs scope alignment and deliverability
      - Circuit breaker validation and risk mitigation planning
      - Task/epic breakdown (separate artifact if needed)
      - Betting table preparation and pitch readiness
      - Final deliverability assessment within appetite

    architect_shape_up_mode:
      - Technical feasibility within appetite constraints (optional)
      - Integration complexity with existing systems assessment
      - Technical risk identification without over-prescription
      - Architecture guidance preserving implementation flexibility
      - Available only when codebase access is present

  handoff_prompts:
    orchestrator_to_analyst: "Appetite defined: {{appetite}}. Now validate the raw problem with user evidence and identify rabbit holes. Use advanced elicitation - ASK CLARIFYING QUESTIONS before proceeding. Save your analysis to docs/problem-validation.md"
    analyst_to_pm: "Problem validation saved to docs/problem-validation.md. Now focus on business perspective and scope boundaries. Use advanced elicitation - ASK CLARIFYING QUESTIONS about business context. Save to docs/business-scope.md"
    pm_to_ux_expert: "Business scope saved to docs/business-scope.md. Now create fat marker sketches using breadboarding technique. Use advanced elicitation - ASK CLARIFYING QUESTIONS about user workflows. Save to docs/solution-sketches.md"
    ux_expert_to_po: "Solution sketches saved to docs/solution-sketches.md. Now validate deliverability within appetite. Use advanced elicitation - ASK CLARIFYING QUESTIONS about delivery constraints. Save to docs/deliverability-assessment.md"
    po_to_architect: "Deliverability assessment saved. Optional: Provide technical feasibility review. Use advanced elicitation - ASK CLARIFYING QUESTIONS about technical context. Save to docs/technical-assessment.md"
    architect_to_orchestrator: "Technical assessment complete. Ready for final pitch creation using shape-up-final-pitch-tmpl template."
    po_to_orchestrator: "Deliverability assessment complete. Ready for final pitch creation using shape-up-final-pitch-tmpl template (no architect needed)."
    issues_found: "Issues found in [section] by [agent]. Please return to [responsible_agent] to fix within appetite constraints. Remember to ask clarifying questions."
    complete: "Shape Up pitch created and saved to docs/shape-up-final-pitch.md. All artifacts saved to docs/ folder and ready for betting table consideration."
